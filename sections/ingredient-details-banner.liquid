{% liquid
  assign id = section.id
  assign settings = section.settings
  assign blocks = section.blocks
%}

<style>
  {{section.settings.cosmetic_font | font_face}}
  {{section.settings.subtitle_font | font_face}}
  .subTitleFont{
    font-family: {{section.settings.subtitle_font.family}};
    font-weight: {{section.settings.subtitle_font.weight}};
  }
  .CosmeticFont{
    font-family: {{section.settings.cosmetic_font.family}};
    font-weight: {{section.settings.cosmetic_font.weight}};
  }
  
    
  #shopify-section-{{id}} {
    box-sizing: border-box;
    margin-top: {{section.settings.margin_top | append: 'px'}};
    margin-bottom: {{section.settings.margin_bottom | append: 'px'}};
    padding-top: {{section.settings.padding_top | append: 'px'}};
    padding-bottom: {{section.settings.padding_bottom | append: 'px'}};
    position: relative;
    background-color: #01a6a5;  
  }
  .card_container-{{ id }} {
    position: absolute;
    bottom: 0;
    right: 0;
    transform: translate(-100px, 142px);
    box-shadow:  0 1px 4px rgba(0,0,0,.6);
    border-radius: 5px;
    max-width: 422px;
    background: #fff;
    padding: 15px;
  }
  .card-{{ id }}{
    position: relative;
  }
  .card-{{ id }} h3{
    font-size: 22px;
    color: #1B0177;
    line-height: 22px;
    margin-top: 0px;
  }
  .card-{{ id }} .card__sm-text{
    font-size: 10px;
    line-height: 14px;
    color: #000;
  }
  .card-{{ id }} .btn_text{{ id }}{
    font-size: 12px;
    line-height: 12px;
    color: #fff;
    background: #6CC27B;
    width: 75px;
    text-align: center;
    padding: 5px;
    margin: 0;
  }
  .card_content-{{ id }} {
    background: #F5F4F0;
    display: grid;
    grid-template-columns: 1fr 1fr;
    grid-gap: 15px;
    flex-direction: column;
    padding: 20px 20px 30px 20px;
    border-radius: 5px;
  }
  .card_content-{{ id }} a{
    margin: 0;
    color: #333333;
    font-size: 14px;
    line-height: 20px; 
  }
  .content_wrapper-{{ id }} {
    display: flex;
    gap: 5px;
  }
  .content_wrapper-{{ id }} a{
    font-size: 14px;
    line-height: 20px;
    color: #000;
  }
  .img_wrapper-{{ id }} img{
    position: absolute;
    top: 0;
    left: 0px;
    transform: translateY(30px);
    width: 94px;
    height: 40px;
    object-fit: cover;
  }
  .heading-{{id}} {
    font-size: 50px;
    line-height: 67px;
    font-weight: bold;
    color: white;
    margin: 0 0 7px 0;
    position: relative;
  }
  .heading-{{id}}:after{
    position: absolute;
    content: "";
    width: 100%;
    height: 5px;
    background: #ffffff36;
    bottom: 0;
    left: 0;
  }
  .sub-heading-{{id}} {
    font-size: 13px;
    line-height: 16px;
    color: white;
    margin: 0 0 15px 0;
  }
  .cosmetic-title-{{id}} {
    font-size: 15px;
    line-height: 18px;
    color: rgb(0,83,83);
    margin: 0 0 3px 0;
    letter-spacing: 0px;
  }
  .cosmetic-text-{{id}} {
    font-size: 12px;
    line-height: 14px;
    color: white;
    margin: 0 0 0 0;
    letter-spacing: 0px;
  }

  @media(max-width: 768px) {
    #shopify-section-{{id}} {
      margin-top: {{section.settings.margin_top_m | append: 'px'}};
      margin-bottom: {{section.settings.margin_bottom_m | append: 'px'}};
      padding-top: {{section.settings.padding_top_m | append: 'px'}};
      padding-bottom: {{section.settings.padding_bottom_m | append: 'px'}};
      background-color: #fff;  
    }
    .sec-{{ id }} {
      display: flex;
      flex-direction: column-reverse;
      gap: 30px;
    }
    .container-{{ id }} {
      background-color: #01a6a5;    
    }
    .card_container-{{ id }} {
      position: unset;
      width: 90%;
      transform: unset;
      margin: auto;
    }
    .card_content-{{ id }} {
      display: flex;
      flex-direction: column;
      gap: 30px;
    }
    .content_wrapper-{{ id }} {
      display: grid;
    }
    .content_wrapper-{{ id }} span{
      justify-self: end;
    }
    .card-{{ id }} .btn_text{{ id }}{
      font-size: 14px;
      line-height: 14px;
      letter-spacing: 0.17px;
      padding: 9px 5px;
      width: 90px;
      margin-bottom: 20px;
    }
    .card-{{ id }} .card__sm-text{
      font-size: 14px;
      line-height: 30px;
      letter-spacing: normal;
    }
    .card-{{ id }} h3{
      margin-bottom: 50px;
    }
    .heading-{{id}} {
      font-size: 38px;
      line-height: 38px;
      font-weight: 700;
      margin: 30px 0 20px 0;
      padding: 0 0 30px 0;
    }
    .info-{{ id }}{
      padding-bottom: 30px;
    }
    .cosmetic-title-{{id}} {
      margin: 0 0 20px 0;
    }
}

</style>


<div class="sec-{{ id }}">
  <div class="{% unless section.settings.full_width %}page-width{% endunless %} container-{{ id }}">
    <div class="wrapper-{{ id }}">
      <div class="info-{{ id }}">
        <h2 class="heading-{{ id }}">{{ section.settings.heading }}</h2>
        <p class="sub-heading-{{ id }} subTitleFont">{{ section.settings.sub_heading }}</p>
        <p class="cosmetic-title-{{ id }} CosmeticFont">Cosmetic / Ingestion Purposes:</p>
        <p class="cosmetic-text-{{ id }} CosmeticFont">{{ section.settings.cosmetic }}</p>
      </div>
    </div>
  </div>
  <div class="card_container-{{ id }} ">
    <div class="card-{{ id }}">
      <h3>{{ section.settings.card_title }}</h3>
      <small class="card__sm-text">{{ section.settings.card_subtitle }}</small>
      <p class="btn_text{{ id }} button-font">{{ section.settings.card_btn }}</p>
      <div class="card_content-{{ id }}">
        {% for block in section.blocks %}
          {% if block.settings.cardd_text %}
            <div class="content_wrapper-{{ id }} modalOpenerItem" data-title="{{ block.settings.cardd_text }}"><span>âœ…</span><a href="/">{{ block.settings.cardd_text }}</a></div>
          {% endif %}
        {% endfor %}
        <h6></h6>
      </div>
     <div class="img_wrapper-{{ id }}"><img  class="card_img-logo-{{ id }}" src="{{ section.settings.logo_img | img_url: "master" }}" alt="Money back"></div>
  </div>
  </div> 
</div>



<style>
  .modal-wrapper-x{
    position: fixed;
    width: 100vw;
    height: 100vh;
    background: rgba(0,0,0,30%);
    z-index: 999;
    left: 0;
    top: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    visibility: hidden;
  }

  .moda-x-header h1{
    margin: 0 0 0 0;
    color: rgb(1, 166, 165);
    font-size: 50px;
    line-height: 1;
  }
  .moda-x-header img{
    width: 100px;
    height: 100px;
    border-radius: 50%;
    object-fit: cover;
    position: absolute;
    right: 0;
    background: white;
    z-index: 2;
  }
  .modal-x-sub-heading {
    margin: 12px 0 0 0;
    color: rgb(51, 51, 51);
    font-size: 20px;
    line-height: 1;
  }
  .modal-x-text{
    color: rgb(51, 51, 51);
    font-size: 14px;
    line-height: 17px;
    text-align: justify;
    margin-top: 30px;
  }
  .modal-x-text a{
    color: rgb(1, 166, 165);
  }
  .modal-card-x {
    background: white;
    box-sizing: border-box;
    padding: 35px 40px;
    border-radius: 30px;
    max-width: 764px;
    position: relative;
    visibility: hidden;
    transform: translateY(30px);
    min-width: 500px;
  }
  .moda-x-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    border-bottom: 4px solid #1b0177;
    position: relative;
  }
  .modal-x-button{
    background: #01a6a5;
    color: white;
    height: 47px;
    line-height: 47px;
    font-size: 16px;
    border: none;
    box-sizing: border-box;
    padding: 0 0;
    min-width: 300px;
    text-align: center;
    border-radius: 25px;
    box-shadow: 0 0 0 7px white;
    position: absolute;
    bottom: -20px;
    left: 50%;
    transform: translateX(-50%);
  }
  .active-modal{
    visibility: visible;
  }
  .active-modal .modal-card-x{
    visibility: visible;
    transform: translateY(0px);
    transition: .4s;
    padding-bottom: 50px;
  }
  .modal-x-close {
    position: absolute;
    width: 40px;
    height: 40px;
    background: white;
    left: 50%;
    transform: translateX(-50%);
    top: -20px;
    z-index: 2;
    border: 2px solid #1b0177;
    border-radius: 50%;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  @media(max-width: 768px) {
    .modal-card-x {
      padding: 20px 20px;
      border-radius: 20px;
      max-width: 95%;
      min-width: 95%;
    }
    .moda-x-header h1 {
      margin: 0 0 0 0;
      color: rgb(1, 166, 165);
      font-size: 40px;
      line-height: 1;
    }
    .moda-x-header img {
      width: 80px;
      height: 80px;
    }
  }
</style>

<modal-x>
    {% for block in section.blocks %}
      <div class="modal-wrapper-x" data-title="{{ block.settings.cardd_text }}">
        <div class="modal-card-x">
          <button class="modal-x-close">X</button>
          <div class="moda-x-header">
            <h1>{{ block.settings.heading }}</h1>
            {% unless block.settings.image == blank %}
              {{ block.settings.image | image_url: width: 100 | image_tag: loading: 'lazy' }}
            {% endunless %}
          </div>
          <h2 class="modal-x-sub-heading">{{ block.settings.sub_heading }}</h2>
          <div class="modal-x-text">{{ block.settings.text }}</div>
          <button class="modal-x-button">Thanks, got it!</button>
        </div>
      </div>
    {% endfor %}
</modal-x>

<script>
  class ModalX extends HTMLElement{
    constructor() {
      super()
      this.items = document.querySelectorAll(".modalOpenerItem")
      this.items.forEach(item => item.addEventListener("click", this.eventHandler.bind(this)))
      this.querySelectorAll(".modal-wrapper-x").forEach(modal => modal.addEventListener("click", this.closeHandler.bind(this)))
    }

    eventHandler(e) {
      e.preventDefault()
      let title = e.currentTarget.dataset.title
      console.log("title", this.title)
      this.querySelectorAll(".modal-wrapper-x").forEach(modal => {
        console.log(modal)
        if(modal.dataset.title === title) {
          console.log(modal)
          modal.classList.add("active-modal")
        }
      })
    }
    closeHandler(e) {
      if(e.target.classList.contains("modal-x-close")) {
        e.target.closest(".active-modal").classList.remove("active-modal")
      }
      if(e.target.classList.contains("active-modal") || e.target.classList.contains("modal-x-close")) {
        e.target.classList.remove("active-modal")
      }
    }
  }

  customElements.define("modal-x", ModalX)
</script>

{% schema %}
  {
    "name": "Ingredient Detail Banner",
    "templates": ["page"],
    "settings": [
      {
        "type": "checkbox",
        "id": "full_width",
        "label": "Full Width Section",
        "default": true
      },
      {
        "type": "textarea",
        "id": "heading",
        "label": "heading",
        "default": "Heading"
      },
      {
        "type": "textarea",
        "id": "sub_heading",
        "label": "Sub heading",
        "default": "Sub Heading"
      },
      {
        "type": "textarea",
        "id": "cosmetic",
        "label": "Cosmetic",
        "default": "Active Ingredient"
      },
      {
        "type": "header",
        "content": "Sub Title Font"
      },
      {
        "type": "font_picker",
        "id": "subtitle_font",
        "label": "Sub Title Font",
        "default": "poppins_n2"
      },
      {
        "type": "header",
        "content": "Cosmetic Font"
      },
      {
        "type": "font_picker",
        "id": "cosmetic_font",
        "label": "Cosmetic Font",
        "default": "poppins_n2"
      },
      {
        "type": "header",
        "content": "Add Card Content"
      },
      {
        "type": "header",
        "content": "Section Spacing Desktop"
      },
      {
        "type": "textarea",
        "id": "card_title",
        "label": "Card Title",
        "default": "Ingredient Analysis"
      },
      {
        "type": "textarea",
        "id": "card_subtitle",
        "label": "Card Subtitle",
        "default": "(Click on text for more information for each category)"
      },
      {
        "type": "image_picker",
        "id": "logo_img",
        "label": "Add Card Logo"
      },
      {
        "type": "textarea",
        "id": "card_btn",
        "label": "Card Button Text",
        "default": "*ORGANIC"
      },
      {
        "type": "range",
        "id": "margin_top",
        "min": 0,
        "max": 200,
        "step": 4,
        "unit": "px",
        "label": "Margin Top",
        "default": 160
      },
      {
        "type": "range",
        "id": "margin_bottom",
        "min": 0,
        "max": 100,
        "step": 1,
        "unit": "px",
        "label": "Margin Bottom",
        "default": 24
      },
      {
        "type": "range",
        "id": "padding_top",
        "min": 0,
        "max": 100,
        "step": 1,
        "unit": "px",
        "label": "Padding Top",
        "default": 0
      },
      {
        "type": "range",
        "id": "padding_bottom",
        "min": 0,
        "max": 100,
        "step": 1,
        "unit": "px",
        "label": "Padding Bottom",
        "default": 0
      },
      {
        "type": "header",
        "content": "Section Spacing Mobile"
      },
      {
        "type": "range",
        "id": "margin_top_m",
        "min": 0,
        "max": 100,
        "step": 1,
        "unit": "px",
        "label": "Margin Top",
        "default": 24
      },
      {
        "type": "range",
        "id": "margin_bottom_m",
        "min": 0,
        "max": 100,
        "step": 1,
        "unit": "px",
        "label": "Margin Bottom",
        "default": 24
      },
      {
        "type": "range",
        "id": "padding_top_m",
        "min": 0,
        "max": 100,
        "step": 1,
        "unit": "px",
        "label": "Padding Top",
        "default": 0
      },
      {
        "type": "range",
        "id": "padding_bottom_m",
        "min": 0,
        "max": 100,
        "step": 1,
        "unit": "px",
        "label": "Padding Bottom",
        "default": 0
      }
    ],
    "blocks": [
      {
        "type": "card",
        "name": "Card column text",
        "settings": [
          {
            "type": "text",
            "id": "cardd_text",
            "label": "text column card"
          },
          {
            "type": "header",
            "content": "Modal Content"
          },
          {
            "type": "image_picker",
            "id": "image",
            "label": "icon"
          },
          {
            "type": "text",
            "id": "heading",
            "label": "Heading",
            "default": "Parabens"
          },
          {
            "type": "text",
            "id": "sub_heading",
            "label": "Sub Heading",
            "default": "Understanding Parabens"
          },
          {
            "type": "richtext",
            "id": "text",
            "label": "Text"
          }
        ]
      }
    ],
    "presets": [
      {
        "name": "Ingredient Detail Banner"
      }
    ]
  }
{% endschema %}

{% stylesheet %}
{% endstylesheet %}

{% javascript %}
{% endjavascript %}